import java.util.ArrayList;
import java.util.Scanner;

public class LibraryManagementSystem {
	// ArrayList is to store booknames
    private static ArrayList<String> bookNames = new ArrayList<>();

    public static void main(String[] args) {
        boolean module = true;
     // Loop keeps the program running until the user exists
        while (module) {
            Scanner myObj = new Scanner(System.in);
            System.out.println("* * * * * * Welcome to the Library Management System * * * * * *");
            System.out.println("Press '1' to start with the program");
            System.out.println("Press '2' to end with the program");
            String selectModule = myObj.nextLine();
 	
 	// Loop will continue inside this method until user exits		
            if (selectModule.equalsIgnoreCase("1")) {
                selectOption(); 
            } else if (selectModule.equalsIgnoreCase("2")) {
                System.out.println("Program ended. Thank you!");
                module = false;
            } else {
                System.out.println("Error, please enter a valid input.");
            }
        }
    }
    // The Method is to display options and handle user selection
    private static void selectOption() {
        boolean module = true;

        while (module) {
            Scanner myObj = new Scanner(System.in);
            System.out.println("\n* * * * * * Operations * * * * * *");
            System.out.println("[A] Add a book");
            System.out.println("[B] Remove a book");
            System.out.println("[C] Display the list and number of books");
            
            // (LIBRARY EMPTY T/F CHECKER)
            System.out.println("[D] Check if the library is Empty"); 
            System.out.println("[E] Exit");

            String optionSelection = myObj.nextLine();

            switch (optionSelection.toUpperCase()) {
                case "A":
                    addBook();
                    break;
                case "B":
                    removeBook();
                    break;
                case "C":
                    displayBooks();
                    break;
              
              // (LIBRARY EMPTY T/F CHECKER)
                case "D":
                    checkIfEmpty(); 
                    break;
                case "E":
                    insertBooks();
                    break;
                case "F": 
                    module = false;
                    break;
                default:
                    System.out.println("Error, please enter a valid option.");
                    break;
            }
        }
    }
    // Method is to add a book to the library
    private static void addBook() {
        Scanner myObj = new Scanner(System.in);
        System.out.println("\n* * * * * * Add a book * * * * * *");
        System.out.print("Enter book name: ");
        String bookName = myObj.nextLine();

        bookNames.add(bookName);

        System.out.println("Book \"" + bookName + "\" added to the library.\n");
    }
   // Method is to remove a book from the library
    private static void removeBook() {
        if (bookNames.isEmpty()) {
            System.out.println("Error, no books available to remove.");
            return;
        }

        Scanner myObj = new Scanner(System.in);
        System.out.println("\n* * * * * * Remove a book * * * * * *");
        System.out.println("List of books: ");
        for (int i = 0; i < bookNames.size(); i++) {
            System.out.println((i + 1) + ". " + bookNames.get(i));
        }
        System.out.print("\nEnter the index number of the book to remove or enter 0 to cancel: ");
        int index = myObj.nextInt();
        
        // Consume newline
        myObj.nextLine(); 

        if (index == 0) {
            System.out.println("No book was removed.");
            return;
        }

        if (index > 0 && index <= bookNames.size()) {
            System.out.println("The book: \"" + bookNames.get(index - 1) + "\" has been removed.");
            bookNames.remove(index - 1);
        } else {
            System.out.println("Error, please enter a valid index.");
        }
    }

    private static void displayBooks() {
        if (bookNames.isEmpty()) {
            System.out.println("No books available.");
        } else {
            System.out.println("\n* * * * * * List of books * * * * * *");
            for (int i = 0; i < bookNames.size(); i++) {
                System.out.println((i + 1) + ". " + bookNames.get(i));
            }
            System.out.println("\n* * * * * * Number of books * * * * * *");
            System.out.println("Quantity: " + bookNames.size());
        }

        Scanner myObj = new Scanner(System.in);
        System.out.print("\Press '1' to return to the main menu: ");
        while (true) {
            String input = myObj.nextLine();
            if (input.equalsIgnoreCase("1")) {
                break;
            } else {
                System.out.print("Invalid input. Please press '1' to return: ");
            }
        }
    }

    // (LIBRARY EMPTY T/F CHECKER)
    private static void checkIfEmpty() {
        boolean isEmpty = bookNames.isEmpty();
        if (isEmpty) {
            System.out.println("The library is empty.(true)");
        } else {
            System.out.println("The library is not empty. (false)");
        }
    }

    // Insert a book at a specific index
    private static void insertBooks() {
    	Scanner myObj = new Scanner (System.in);
    	
    	System.out.println("\n* * * * * * Insert a book at a specific index * * * * * *");
        System.out.print("Enter book name: ");
        String bookName = myObj.nextLine();
        
        if (bookNames.isEmpty()) {
        	System.out.println("Booklist is currently empty.");
        	bookNames.add(0, bookName);
        }
        else {
        	System.out.print("Enter the specific index at which to insert the book (1 to " + (bookNames.size()+1) + "): \nEnter 0 to cancel.");
        	int index = myObj.nextInt();
        	myObj.nextLine();
        	
        	if (index>=1 && index<= bookNames.size()+1) {
        		bookNames.add(index - 1, bookName);
        		System.out.println ("Book \"" + bookName + "\" added at index " + index + ".\n");
        	}
        	else {
        		System.out.println("Invalid index. The book was not added to the library.");
        	}
        }
    }
}
